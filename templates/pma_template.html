{% extends "base.html" %}
{% block title %}Calculate PMA{% endblock %}
{% block body_class %}pma-page{% endblock %}

{% block content %}
<div class="container" style="max-width:420px;margin:auto">
  <h1>Calculate Postmenstrual Age (PMA)</h1>

  <form method="post" action="{{ u('calculate_pma_route') }}">
    <div class="form-group">
      <label>Gestational Age:</label>
      <div class="form-inline" style="display:flex;align-items:center;gap:8px">
        <input type="number" name="gestational_age_weeks" placeholder="Weeks" required
               value="{{ ga_w_val|default('') }}">
        <span>wks</span>
        <input type="number" name="gestational_age_days" placeholder="Days" required
               value="{{ ga_d_val|default('') }}">
        <span>day</span>
      </div>
    </div>

    <div class="form-inline" style="display:flex;align-items:center;gap:10px;margin-bottom:10px">
      <label style="flex:1">Postnatal Age (Days):</label>
      <input type="number" name="postnatal_age_days" placeholder="Days" required style="flex:1"
             value="{{ pna_d_val|default('') }}">
      <span style="flex:0.2;text-align:right">day</span>
    </div>

    <div class="form-inline" style="display:flex;align-items:center;gap:10px">
      <label style="flex:1">Birth Weight (kg):</label>
      <input type="number" name="bw" placeholder="kg" step="0.001" required style="flex:1"
             value="{{ bw|default('') }}">
      <span style="flex:0.2;text-align:right">kg</span>
    </div>

    <button type="submit" style="margin-top:16px">Calculate PMA</button>
  </form>

  {% if pma_weeks is defined %}
  <div class="result" style="display:block;margin-top:16px;background:#f0f0f0;padding:12px;border-radius:8px">
    <p>PMA: <b style="color:blue">{{ pma_weeks }} weeks and {{ pma_days }} days</b></p>
    <p>Calc.: <b style="color:blue">{{ calc_unit or 'weeks' }}</b></p>
    <p>Postnatal Age: <b style="color:blue">{{ postnatal_days }} days</b></p>
    <p>Birth Weight (BW): <b style="color:blue">{{ bw|fmt(3) }} kg</b></p>

    <form method="get" action="{{ u('drug_calculation') }}">
      <input type="hidden" name="pma_weeks" value="{{ pma_weeks }}">
      <input type="hidden" name="pma_days"  value="{{ pma_days }}">
      <input type="hidden" name="postnatal_days" value="{{ postnatal_days }}">
      <input type="hidden" name="bw" value="{{ bw }}">
      <button class="drug-button" type="submit">คำนวณยา</button>
    </form>
  </div>
  {% endif %}
</div>

<div class="button-group" style="text-align:center;margin-top:12px">
  <a href="javascript:history.back()" class="back-button-secondary">Back</a>
  <a href="{{ u('index') }}" class="back-button">Back to Home</a>
</div>

<footer style="text-align:center;margin-top:12px;color:#fff;text-shadow:0 1px 3px #000">
  <p>Developed by Sukhontha Boonsookchan | update 2025-11-06 01:51</p>
</footer>
{% endblock %}
