{% extends "base.html" %}

{% block title %}Drug Compatibility{% endblock %}

{% block content %}
<div class="container" style="max-width:900px;margin:auto">
  <h2 class="title-badge">ตรวจสอบความเข้ากันได้ของยา (Drug Compatibility)</h2>

  {% if error %}
    <div class="alert alert-danger" style="margin-bottom:1rem">{{ error }}</div>
  {% endif %}

  <form method="post" action="{{ url_for('compat.compat_index') }}" class="calc-box">
    <div class="row">
      <div class="col-md-6">
        <label for="drug_a"><b>Drug A</b></label>
        <select id="drug_a" name="drug_a" class="form-control" required>
          <option value="">-- เลือกยา --</option>
          {% for letter, items in groups.items() %}
            <optgroup label="{{ letter }}">
              {% for d in items %}
                <option value="{{ d.id }}"
                        {% if selected_drug_id and selected_drug_id|string == d.id|string %}selected{% endif %}>
                  {{ d.generic_name }}
                </option>
              {% endfor %}
            </optgroup>
          {% endfor %}
        </select>
      </div>

      <div class="col-md-6">
        <label for="drug_b"><b>Drug B</b></label>
        <select id="drug_b" name="drug_b" class="form-control" required>
          <option value="">-- เลือกยา --</option>
          {% for letter, items in groups.items() %}
            <optgroup label="{{ letter }}">
              {% for d in items %}
                <option value="{{ d.id }}"
                        {% if selected_co_drug_id and selected_co_drug_id|string == d.id|string %}selected{% endif %}>
                  {{ d.generic_name }}
                </option>
              {% endfor %}
            </optgroup>
          {% endfor %}
        </select>
      </div>
    </div>

    <div style="margin-top:1.5rem;text-align:center">
      <button type="submit" class="btn btn-primary">ตรวจสอบ Compatibility</button>
      <a href="{{ url_for('index') }}" class="btn btn-secondary">กลับหน้า Home</a>
    </div>

    <div style="margin-top:1rem;text-align:center;font-size:0.9rem">
      <span style="color:#16a34a;">● C = Compatible / ผสมร่วมได้</span>
      &nbsp;&nbsp;
      <span style="color:#dc2626;">● I = Incompatible / ห้ามผสม</span>
      &nbsp;&nbsp;
      <span style="color:#f59e0b;">● U = Uncertain / ไม่ชัดเจน</span>
      &nbsp;&nbsp;
      <span style="color:#2563eb;">● ND = No data / ไม่มีข้อมูล</span>
    </div>
  </form>
</div>
{% endblock %}
