<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Result analyze (Compatibility)</title>

  <meta name="theme-color" content="#0ea5a6" />
  <link rel="manifest" href="./static/manifest.webmanifest">
  <link rel="apple-touch-icon" href="./static/icons/icon-192.png">
  <link rel="icon" href="./static/icons/icon-192.png">

  <link rel="stylesheet" href="./static/style.css">
  <script defer src="./static/app.js"></script>

  <style>
    :root{ color-scheme: light only; }
    body{
      margin:0; min-height:100vh;
      font-family: Arial, Helvetica, sans-serif;
      background-image:url("https://cdn.jsdelivr.net/gh/060531/images/IMG_4200.jpeg");
      background-size:cover; background-position:center; background-repeat:no-repeat;
      display:flex; flex-direction:column; align-items:center;
    }
    .wrap{ width:min(920px,96vw); margin:22px auto 90px; }
    .title-badge{
      display:inline-block; margin:18px auto 14px; padding:12px 22px;
      border-radius:16px; color:#fff; font-weight:900;
      background:linear-gradient(135deg,#0291a6,#0b7285);
      box-shadow:0 12px 26px rgba(15,23,42,.22);
    }
    .card{
      margin:0 auto;
      background:rgba(255,255,255,.88);
      border-radius:18px;
      padding:20px 18px;
      box-shadow:0 18px 40px rgba(15,23,42,.25);
      text-align:center;
    }
    .pair{ font-size:16px; color:#0f172a; margin-top:6px; }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 14px; border-radius:999px;
      font-weight:900; margin:10px 0 6px;
      border:1px solid rgba(15,23,42,.12);
    }
    .dot{ width:10px; height:10px; border-radius:999px; }
    .meta{
      margin-top:10px;
      padding:12px 12px;
      border-radius:12px;
      background:#f1f5f9;
      border:1px dashed #cbd5e1;
      text-align:left;
      color:#0f172a;
      font-size:14px;
    }
    .meta b{ color:#0b5f72; }
    .actions{ margin-top:14px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
    .btn{
      border:none; cursor:pointer; text-decoration:none;
      padding:10px 16px; border-radius:999px; font-weight:800;
      box-shadow:0 10px 20px rgba(15,23,42,.18);
      display:inline-flex; align-items:center; gap:8px;
    }
    .btn.primary{ background:#16a34a; color:#fff; }
    .btn.gray{ background:#e5e7eb; color:#0f172a; }
    footer{
      margin-top:auto; color:#fff; font-size:12px;
      padding:10px; text-shadow:0 1px 2px rgba(0,0,0,.6);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div style="text-align:center">
      <div class="title-badge">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏¢‡∏≤<br><small style="opacity:.9;font-weight:700">Drug Compatibility</small></div>
    </div>

    <div class="card">
      <h2 style="margin:0;color:#0b5f72">Result analyze</h2>
      <div id="pairText" class="pair">-</div>

      <div id="statusBadge" class="badge" style="background:#e2e8f0">
        <span id="statusDot" class="dot" style="background:#64748b"></span>
        <span id="statusText">Loading...</span>
      </div>

      <div class="meta">
        <div><b>Source:</b> <span id="sourceText">-</span></div>
        <div style="margin-top:6px"><b>Note:</b> <span id="noteText">-</span></div>
      </div>

      <div class="actions">
        <a class="btn primary" href="./compatibility.html">‚Ü∫ New check</a>
        <a class="btn gray" href="./index.html">üè† Home</a>
      </div>

      <div style="margin-top:10px;font-size:12px;color:#475569">
        ‚óè C = Compatible / ‡∏ú‡∏™‡∏°‡∏£‡πà‡∏ß‡∏°‡πÑ‡∏î‡πâ &nbsp; ‚óè I = Incompatible / ‡∏´‡πâ‡∏≤‡∏°‡∏ú‡∏™‡∏° &nbsp; ‚óè U = Uncertain &nbsp; ‚óè ND = No data
      </div>
    </div>
  </div>

  <footer>Developed by Sukhontha Boonsookchan | update 2025-11-15</footer>

  <script>
    const STATUS_UI = {
      C:  { label: "C Compatible",   dot:"#16a34a", bg:"#dcfce7" },
      I:  { label: "I Incompatible", dot:"#ef4444", bg:"#fee2e2" },
      U:  { label: "U Uncertain",    dot:"#f59e0b", bg:"#fef3c7" },
      ND: { label: "ND No data",     dot:"#3b82f6", bg:"#dbeafe" },
    };

    const norm = (s) => (s || "")
      .toString()
      .trim()
      .toLowerCase()
      .replace(/\+/g, " ")
      .replace(/\s+/g, " ")
      .replace(/[‚Äú‚Äù"]/g, "")
      .replace(/[‚Äô']/g, "");

    const qs = new URLSearchParams(location.search);
    const drugA_raw = qs.get("drug_a") || "";
    const drugB_raw = qs.get("drug_b") || "";

    document.getElementById("pairText").textContent =
      `${drugA_raw || "-"} with ${drugB_raw || "-"}`;

    async function loadLookup() {
      // ‚úÖ ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ /static/... (absolute) ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ GH Pages ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ï‡πâ /neonatal-medication-calculator/
      const url = "./static/compat_lookup.json?v=" + Date.now();
      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) throw new Error("fetch compat_lookup.json failed: " + res.status);
      return res.json();
    }

    function paint(status, source, note) {
      const ui = STATUS_UI[status] || STATUS_UI.ND;
      const badge = document.getElementById("statusBadge");
      const dot = document.getElementById("statusDot");
      const txt = document.getElementById("statusText");
      badge.style.background = ui.bg;
      dot.style.background = ui.dot;
      txt.textContent = ui.label;

      document.getElementById("sourceText").textContent = source || "-";
      document.getElementById("noteText").textContent = note || "-";
    }

    (async () => {
      try {
        const a = norm(drugA_raw);
        const b = norm(drugB_raw);

        if (!a || !b) {
          paint("ND", "-", "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö (drug_a/drug_b)");
          return;
        }

        const data = await loadLookup();

        const k1 = `${a}|${b}`;
        const k2 = `${b}|${a}`;
        const hit = data[k1] || data[k2];

        if (!hit) {
          paint("ND", "-", "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏π‡πà‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤/‡∏™‡∏∞‡∏Å‡∏î ‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà)");
          return;
        }

        paint(hit.status || "ND", hit.source, hit.note);
      } catch (e) {
        console.error(e);
        paint("ND", "-", "‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ compat_lookup.json ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ./static/ ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡πÅ‡∏ö‡∏ö 200)");
      }
    })();
  </script>
</body>
</html>
