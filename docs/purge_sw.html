<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Purge SW</title>
</head>
<body style="font-family:Arial;padding:24px">
  <h2>ล้าง Service Worker + Cache</h2>
  <p>หน้านี้ใช้แก้ปัญหา cache ค้างบน GitHub Pages</p>
  <button id="go" style="padding:10px 16px;border-radius:10px;border:0;background:#ef4444;color:#fff;font-weight:700;cursor:pointer">
    ล้างแล้วกลับหน้า Home
  </button>

  <script>
    document.getElementById("go").addEventListener("click", async () => {
      try {
        if ("serviceWorker" in navigator) {
          const regs = await navigator.serviceWorker.getRegistrations();
          await Promise.all(regs.map(r => r.unregister()));
        }
        if ("caches" in window) {
          const keys = await caches.keys();
          await Promise.all(keys.map(k => caches.delete(k)));
        }
      } catch (e) {}
      location.href = "./index.html?purged=1";
    });
  </script>
</body>
</html>
