<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Ceftazidime (Fortum) Calculation</title>
<style>
  :root{--blue-900:#0b2b7a;--blue-700:#1e57d2;--sky-50:#eef7ff;--sky-100:#d7ecff;--panel:#e6f3ffb8;--text:#0f172a;--floatbar-gap:clamp(80px,16vw,110px);--page-gutter:12px}
  html,body{overflow-x:hidden;height:100%}*,*::before,*::after{box-sizing:border-box}img,video,canvas,svg{max-width:100%;height:auto}pre,code{white-space:pre-wrap;word-break:break-word}
  body{margin:0;min-height:100svh;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Arial,"Helvetica Neue",Helvetica,sans-serif;color:var(--text);text-align:center;background:none;padding-left:max(0px,env(safe-area-inset-left));padding-right:max(0px,env(safe-area-inset-right))}
  body::before{content:"";position:fixed;inset:0;z-index:-1;background-image:url('https://cdn.jsdelivr.net/gh/060531/images/IMG_4200.jpeg');background-size:cover;background-position:center;background-repeat:no-repeat}
  .title-badge{display:inline-block;margin:28px auto 12px;padding:10px 18px;background:var(--blue-900);color:#fff;font-weight:900;font-size:28px;border-radius:12px;box-shadow:0 10px 22px rgba(7,29,85,.35),inset 0 1px 0 rgba(255,255,255,.18);border:1px solid rgba(255,255,255,.14);max-width:min(100%,calc(100vw - calc(var(--page-gutter)*2)))}
  .container{width:min(820px,calc(100vw - calc(var(--page-gutter)*2)));margin:0 auto 12px;padding:20px;background:var(--panel);border:1px solid #b9d9ff;border-radius:16px;box-shadow:0 8px 24px rgba(15,23,42,.18);backdrop-filter:blur(6px) saturate(120%);-webkit-backdrop-filter:blur(6px) saturate(120%)}
  .calc-box{margin:14px auto 20px;max-width:740px;padding:16px;background:linear-gradient(180deg,var(--sky-100),var(--sky-50));border:1px solid #b7d6ff;border-radius:14px;box-shadow:inset 0 1px 0 rgba(255,255,255,.6),0 8px 18px rgba(0,0,0,.06);padding-left:max(12px,var(--page-gutter));padding-right:max(12px,var(--page-gutter))}
  .calc-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:center}
  input[type="number"],select{width:clamp(160px,50vw,220px);max-width:60vw;padding:10px 12px;border-radius:10px;border:1px solid #c7d9f9;background:#fff;font-size:16px;text-align:center}
  .btn{appearance:none;border:none;border-radius:10px;cursor:pointer;padding:10px 16px;font-weight:800;color:#fff;text-decoration:none;box-shadow:0 6px 0 rgba(10,30,85,.25);transition:transform .06s ease,filter .2s ease}
  .btn:hover{filter:brightness(1.05);transform:translateY(-1px)} .btn:active{transform:translateY(1px)} .btn-blue{background:var(--blue-700)} .btn-red{background:#e71f1f} .btn-cyan{background:#049bb5}
  .result{text-align:left;margin:14px auto;max-width:740px;padding:14px;background:#f7fbff;border:1px dashed #cfe3ff;border-radius:12px;padding-left:max(12px,var(--page-gutter));padding-right:max(12px,var(--page-gutter))}
  .result b{color:#0b2b7a}.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#1d3e8c;color:#fff;padding:2px 6px;border-radius:6px;font-weight:800}
  .muted{color:#334155}.section-head{text-align:left;font-weight:900;color:#0b2b7a;margin:18px 0 6px;text-decoration:underline}
  .bullet{text-align:left;margin:0 0 10px 0}.bullet ul{margin:6px 0 0 22px}.pill{display:inline-block;padding:2px 6px;border-radius:6px;background:#e01b1b;color:#fff;font-weight:800}
  .left-align{text-align:left}
  .order-line{text-align:center;margin:6px 0}
  .hidden{display:none !important;}
  /* ===== Floating actions (base) ===== */
.float-actions{
  position:fixed!important;
  left:50%;
  bottom:calc(10px + env(safe-area-inset-bottom,0px));
  transform:translateX(-50%);
  z-index:9999;
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:center;

  /* ✅ ทำให้แถบกว้างพอในจอเล็ก และไม่ชนขอบ */
  width:min(380px, calc(100vw - 24px));

  padding:8px 10px;
  border-radius:14px;
  background:rgba(15,23,42,.35);
  border:1px solid rgba(255,255,255,.2);
  box-shadow:0 8px 18px rgba(2,8,23,.28);
  backdrop-filter:blur(8px) saturate(120%);
  -webkit-backdrop-filter:blur(8px) saturate(120%);
}

.float-actions .btn{
  /* ✅ ทำให้ปุ่ม 2 อัน “กว้างเท่ากัน” */
  flex:1 1 0;
  min-width:0;

  /* ✅ กันข้อความแตกบรรทัด */
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;

  /* ✅ จัดกลางสวยและสูงเท่ากัน */
  display:flex;
  align-items:center;
  justify-content:center;
  line-height:1;
  min-height:40px;

  font-weight:700;
  border-radius:12px;
}

/* ===== Mobile tweaks ===== */
@media (max-width:640px){
  .float-actions{
    width:min(360px, calc(100vw - 16px));
    gap:10px;
    padding:8px;
  }
  .float-actions .btn{
    font-size:14px;
    padding:10px 12px;
    min-height:38px;
  }
}

  footer.page-footer{text-align:center;color:#ffffff;text-shadow:0 2px 6px rgba(0,0,0,.5);margin:6px 0 var(--floatbar-gap);padding-left:var(--page-gutter);padding-right:var(--page-gutter);font-size:clamp(12px,3.2vw,16px);line-height:1.4}
  @media (max-width:640px){.dose-row,.conc-row{display:grid;grid-template-columns:auto 1fr;align-items:center;column-gap:8px;width:100%;max-width:520px;margin-left:auto;margin-right:auto}
    .dose-row>label,.conc-row>label{white-space:nowrap;max-width:44vw;font-size:14px;line-height:1.2}
    .dose-row>input[type="number"],.conc-row>select{min-width:0;width:100%;font-size:14px;padding:8px 10px;height:38px;box-sizing:border-box}
    .calc-row>.btn{min-width:120px}}
</style>
</head>
<body>

  <div class="title-badge">Ceftazidime (Fortum) : 1000 mg / Vial</div>

  <div class="container">
    <!-- รอบที่ 1: คำนวณ mg → mL -->
    <div class="calc-box">
      <form action="./ceftazidime.html" method="post" class="calc-row">
        <input type="hidden" name="step" value="dose" />
        <div class="dose-row">
          <label for="dose">กรอกขนาดยา (mg):</label>
          <input type="number" id="dose" name="dose" placeholder="ขนาดยา (mg)" required step="0.01" value="">
        </div>
        <button type="submit" class="btn btn-blue">คำนวณ</button>
      </form>
    </div>

    

    

    <!-- รอบที่ 2: เลือกเงื่อนไข (ซ่อนตอนเริ่ม) -->
    <div class="calc-box hidden"
         id="step2-box">
      <form action="./ceftazidime.html" method="post" class="calc-row">
        <input type="hidden" name="step" value="condition" />
        <input type="hidden" name="dose" value="">
        <input type="hidden" name="result_ml" value="">
        <label for="multiplication">เลือกเงื่อนไข:</label>
        <select name="multiplication" id="multiplication" required>
          <option value="" disabled selected>— เลือก —</option>
          <option value="3" >3 เท่า (รวมเป้าหมาย 9 mL)</option>
          <option value="6" >6 เท่า (รวมเป้าหมาย 6 mL)</option>
        </select>

        <button type="submit" class="btn btn-blue">คำนวณต่อ</button>
      </form>
    </div>

    

    

    <!-- หมายเหตุ/วิชาการ -->
    <div class="bullet">
      <p class="muted">☞ <b>ขนาดยาแนะนำ:</b> 30 mg/kg/dose</p>

      <p class="section-head">Solvent</p>
      <ul class="muted">
        <li><b>Sterile water 9.5 mL</b></li>
        <li>จะได้สารละลายใส ไม่มีสี 10 mL</li>
        <li><u>ความแรง 100 mg/mL</u></li>
      </ul>

      <p class="section-head">Solution</p>
      <ul class="muted">
        <li>0.9% Normal saline solution / NSS</li>
        <li>5% Dextrose in water</li>
      </ul>

      <p class="section-head">ความเข้มข้นสูงสุดในการบริหารยา</p>
      <ul class="muted"><li>≤ 40 mg/mL</li></ul>

      <p class="section-head">ระยะเวลาในการบริหารยา</p>
      <ul class="muted"><li>≈ 30 mins</li></ul>

      <p class="section-head">ความคงตัวหลังเจือจาง</p>
      <ul class="muted"><li>24 ชั่วโมง ที่อุณหภูมิห้อง 15–25°C</li></ul>

      <p class="section-head">ข้อควรระวัง / การติดตาม</p>
      <ul class="muted"><li>Anaphylaxis ระหว่างให้ครั้งแรก</li></ul>

      <p class="item"><b>Half-life:</b> 3 – 12 hrs.</p>
    </div>
  </div><!-- /container -->

  <footer class="page-footer">
    <p>Developed by Sukhontha Boonsookchan | update 2025-12-04 19:21</p>
  </footer>

  <div class="float-actions">
    <a href="./Medication_administration.html" class="btn btn-cyan" data-nav="med">Back</a>
    <a href="./index.html" class="btn btn-red" data-nav="home">Back to Home</a>
  </div>

  <script>
(function () {
  var host = window.location.hostname || "";
  var isGithub = host.endsWith("github.io");


  // ถ้าไม่ใช่ GitHub → ให้ Flask ทำงานตามปกติ
  if (!isGithub) return;

  // หา form รอบที่ 1 / รอบที่ 2 จาก input[name="step"]
  var doseActionInput = document.querySelector('input[name="step"][value="dose"]');
  var condActionInput = document.querySelector('input[name="step"][value="condition"]');
  if (!doseActionInput || !condActionInput) return;

  var formDose = doseActionInput.form;
  var formCond = condActionInput.form;
  if (!formDose || !formCond) return;

  var doseInput  = document.getElementById("dose");
  var multSelect = document.getElementById("multiplication");
  if (!doseInput || !multSelect) return;

  // hidden ในฟอร์มรอบที่ 2 ชื่อ dose / result_ml
  var hiddenDose   = formCond.querySelector('input[name="dose"]');
  var hiddenResult = formCond.querySelector('input[name="result_ml"]');
  if (!hiddenDose || !hiddenResult) return;

  var step2Box = document.getElementById("step2-box");

  var doseVal = null;
  var resultMlVal = null;

  function round2(x) {
    return Math.round((x + Number.EPSILON) * 100) / 100;
  }

  function createOrGetBox(id, refNode) {
    var box = document.getElementById(id);
    if (!box) {
      box = document.createElement("div");
      box.id = id;
      box.className = "result";
      refNode.parentNode.insertBefore(box, refNode.nextSibling);
    }
    return box;
  }

  // ---------- STEP 1: dose (mg) → mL ----------
  formDose.addEventListener("submit", function (e) {
    e.preventDefault();

    var raw = (doseInput.value || "").trim();
    var d = parseFloat(raw);
    if (!raw || isNaN(d) || d < 0) {
      alert("กรุณากรอกขนาดยา (mg) เป็นตัวเลข ≥ 0");
      return;
    }

    doseVal     = round2(d);
    // stock 1000 mg / 10 mL → mL = (mg × 10) / 1000
    resultMlVal = round2((doseVal * 10.0) / 1000.0);

    hiddenDose.value   = doseVal.toFixed(2);
    hiddenResult.value = resultMlVal.toFixed(2);

    var box = createOrGetBox("gh-ceftazidime-step1", formDose.closest(".calc-box"));
    box.innerHTML =
      "<p class='order-line'><b>Order:</b> Ceftazidime " + doseVal.toFixed(2) + " mg</p>" +
      "<p><b>สูตรจากสต็อก 1000 mg / 10 mL</b> → " +
      "<span class='mono'>mL = (mg × 10) / 1000</span></p>" +
      "<p>แทนค่า: <span class='mono'>" +
      doseVal.toFixed(2) + " × 10 / 1000 = " +
      "<span class='pill'>" + resultMlVal.toFixed(2) + "</span> mL</span></p>";

    // เปิดให้ step 2 ใช้งานได้ (แสดงกล่อง)
    if (step2Box) {
      step2Box.classList.remove("hidden");
    }
  });

  // ---------- STEP 2: เงื่อนไข 3X / 6X + content_extra ----------
  formCond.addEventListener("submit", function (e) {
    e.preventDefault();

    if (doseVal === null || resultMlVal === null) {
      alert("โปรดคำนวณรอบแรกก่อน");
      return;
    }

    var mRaw = (multSelect.value || "").trim();
    var m = parseInt(mRaw, 10);
    if (!m || (m !== 3 && m !== 6)) {
      alert("กรุณาเลือกเงื่อนไข 3 หรือ 6 เท่า");
      return;
    }

    var total   = round2(resultMlVal * m);
    var target  = (m === 3) ? 9.0 : 6.0;
    var diluent = round2(Math.max(target - total, 0));

    // กล่องผลลัพธ์เหมือน Jinja block
    var boxMain = createOrGetBox("gh-ceftazidime-step2", formCond.closest(".calc-box"));
    var htmlMain =
      "<p><b>ผลลัพธ์หลังจากคูณ " + m + " เท่า = " + total.toFixed(2) + " mL</b></p>" +
      "<div class='left-align'>";

    if (m === 3) {
      if (total < 9) {
        htmlMain += "<p><b>ดังนั้น สารละลายที่ต้องผสม :</b> (9 − " +
                    total.toFixed(2) + ") = " + diluent.toFixed(2) + " mL</p>";
      } else {
        htmlMain += "<p><b>**ดูดยา : 9 mL ไม่ต้องผสมสารละลาย**</b></p>";
      }
      htmlMain += "<p style='background:#f1b81b; padding:5px; border-radius:5px;'>" +
                  "<b>ปริมาณยาที่บริหารเข้าทารก = 3 mL → ตั้งอัตรา ~6 mL/hr</b></p>";
    } else {
      if (total < 6) {
        htmlMain += "<p><b>ดังนั้น สารละลายที่ต้องผสม :</b> (6 − " +
                    total.toFixed(2) + ") = " + diluent.toFixed(2) + " mL</p>";
      } else {
        htmlMain += "<p><b>**ดูดยา : 6 mL ไม่ต้องผสมสารละลาย**</b></p>";
      }
      htmlMain += "<p style='background:#f1b81b; padding:5px; border-radius:5px;'>" +
                  "<b>ปริมาณยาที่บริหารเข้าทารก = 1 mL → ตั้งอัตรา ~2 mL/hr</b></p>";
    }

    htmlMain += "</div>";
    boxMain.innerHTML = htmlMain;

    // กล่องคำอธิบาย content_extra
    var config;
    if (m === 3) {
      config = {
        message: "การบริหารยาโดย Intermittent intravenous infusion pump",
        details: [
          "สำหรับทารกที่มีน้ำหนักมากกว่า 1,500 กรัม",
          "กำหนดให้ปริมาณสารละลายยา (ปริมาณยา + สารละลายเชื้อจางยา) = 8 ml.",
          "(ความจุของ Extension Tube ประมาณ 5 ml. + Volume ที่ต้องบริหารเข้าผู้ป่วย 3 ml.)",
          "<div style='text-align:center'>(3X + สารละลายเจือจางยา Up to 9 mL)</div>",
          "การเตรียมยา:",
          "1) คำนวณปริมาณยาที่ต้องการใช้เป็นมิลลิลิตร (ml.) แทนค่าในสูตร",
          "2) ใช้ Syringe ขนาดที่เหมาะสม ดูดปริมาณยาที่ต้องการเตรียมไว้",
          "3) ใช้ Syringe ขนาด 10 ml. หรือ 20 ml. ดูดปริมาณสารละลายเชื้อจางยาเตรียมไว้",
          "4) ผสมยาใน Syringe ที่มีสารละลายเชื้อจางยาอยู่ Mixed ให้เข้ากัน",
          "5) ต่อ Syringe กับ Extension Tube นำไปวางบน Syringe pump กด Start ตั้งอัตรา ~6 mL/hr.",
          "6) Purge ยาให้ทั่วท่อโดยการดัน Syringe 3 ml. แล้วจึงบริหารผู้ป่วย",
        ]
      };
    } else {
      config = {
        message: "การบริหารยาโดย Intermittent intravenous infusion",
        details: [
          "สำหรับทารกที่มีน้ำหนักน้อยกว่า 1,500 กรัม",
          "1) กำหนดให้สารละลายยาซึ่งบริหารเข้าสู้ผู้ป่วยปริมาณเท่ากับ = 1 mL",
          "2) ให้ X คือ ปริมาณยาที่ต้องการเตรียม กำหนดสูตรในการเตรียมสารละลายยา ดังนี้:",
          "<div style='text-align:center'>6X + สารละลายเจือจางยา Up to 6 mL</div>",
          "3) จากข้อ 2 จะได้สารละลายทั้งหมด 6 ml. ซึ่งหมายถึง ความจุของ Extension Tube ประมาณ 5 ml. + Volume ที่ต้องการบริหารเข้าสู่ผู้ป่วย 1 ml.",
          "4) บริหารโดยใช้ Syringe pump ตั้งอัตราเร็ว ~2 mL/hr",
        ]
      };
    }

    var boxExtra = createOrGetBox("gh-ceftazidime-extra", boxMain);
    var html =
      "<p style='font-weight:900; text-align:center; margin:6px 0'>" +
      config.message + "</p><div class='muted'>";
    config.details.forEach(function (d) {
      if (d.indexOf("Up to") !== -1) {
        html += "<div style='background:#ffeb3b; font-weight:700; padding:8px; text-align:center; border-radius:6px; margin:10px 0'>" +
                d + "</div>";
      } else {
        html += "<p style='margin:6px 0'>" + d + "</p>";
      }
    });
    html += "</div>";
    boxExtra.innerHTML = html;
  });
})();
</script>

</body>
</html>