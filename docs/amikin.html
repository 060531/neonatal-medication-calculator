<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Amikacin (Amikin) Calculation</title>
  <style>
    :root{
      --blue-900:#0b2b7a; --blue-700:#1e57d2;
      --sky-50:#eef7ff; --sky-100:#d7ecff;
      --panel:#e6f3ffb8; --text:#0f172a;
      --floatbar-gap:clamp(80px,16vw,110px);
      --page-gutter:12px;
    }
    html,body{overflow-x:hidden;height:100%}
    *,*:before,*:after{box-sizing:border-box}
    body{
      margin:0;
      min-height:100svh;
      font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Arial,"Helvetica Neue",Helvetica,sans-serif;
      color:var(--text);
      text-align:center;
      background:none;
      padding-left:max(0px,env(safe-area-inset-left));
      padding-right:max(0px,env(safe-area-inset-right));
    }
    body::before{
      content:"";
      position:fixed;
      inset:0;
      z-index:-1;
      background-image:url('https://cdn.jsdelivr.net/gh/060531/images/IMG_4200.jpeg');
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
    }
    .title-badge{
      display:inline-block;
      margin:28px auto 12px;
      padding:10px 18px;
      background:var(--blue-900);
      color:#fff;
      font-weight:900;
      font-size:28px;
      border-radius:12px;
      box-shadow:0 10px 22px rgba(7,29,85,.35),
                 inset 0 1px 0 rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.14);
      max-width:min(100%,calc(100vw - calc(var(--page-gutter)*2)));
    }
    .container{
      width:min(820px,calc(100vw - calc(var(--page-gutter)*2)));
      margin:0 auto 12px;
      padding:20px;
      background:var(--panel);
      border:1px solid #b9d9ff;
      border-radius:16px;
      box-shadow:0 8px 24px rgba(15,23,42,.18);
      backdrop-filter:blur(6px) saturate(120%);
      -webkit-backdrop-filter:blur(6px) saturate(120%);
    }
    .calc-box{
      margin:14px auto 20px;
      max-width:740px;
      padding:16px;
      background:linear-gradient(180deg,var(--sky-100),var(--sky-50));
      border:1px solid #b7d6ff;
      border-radius:14px;
      box-shadow:inset 0 1px 0 rgba(255,255,255,.6),
                 0 8px 18px rgba(0,0,0,.06);
      padding-left:max(12px,var(--page-gutter));
      padding-right:max(12px,var(--page-gutter));
    }
    .calc-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:center;
    }
    input[type="number"],select{
      width:clamp(160px,50vw,220px);
      max-width:60vw;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid #c7d9f9;
      background:#fff;
      font-size:16px;
      text-align:center;
    }
    .result{
      text-align:left;
      margin:14px auto;
      max-width:740px;
      padding:14px;
      background:#f7fbff;
      border:1px dashed #cfe3ff;
      border-radius:12px;
      padding-left:max(12px,var(--page-gutter));
      padding-right:max(12px,var(--page-gutter));
    }
    .result b{color:#0b2b7a}
    .mono{
      font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
      background:#1d3e8c;
      color:#fff;
      padding:2px 6px;
      border-radius:6px;
      font-weight:800;
    }
    .muted{color:#334155}
    .section-head{
      text-align:left;
      font-weight:900;
      color:#0b2b7a;
      margin:18px 0 6px;
      text-decoration:underline;
    }
    .bullet{text-align:left;margin:0 0 10px 0}
    .bullet ul{margin:6px 0 0 22px}
    .btn{
      appearance:none;
      border:none;
      border-radius:10px;
      cursor:pointer;
      padding:10px 16px;
      font-weight:800;
      color:#fff;
      text-decoration:none;
      box-shadow:0 6px 0 rgba(10,30,85,.25);
      transition:transform .06s ease,filter .2s ease;
    }
    .btn:hover{filter:brightness(1.05);transform:translateY(-1px)}
    .btn:active{transform:translateY(1px)}
    .btn-blue{background:var(--blue-700)}
    .btn-red{background:#e71f1f}
    .btn-cyan{background:#049bb5}
    .pill-red{
      display:inline-block;
      padding:2px 6px;
      border-radius:6px;
      background:#e01b1b;
      color:#fff;
      font-weight:800;
    }
    .float-actions{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:calc(10px + env(safe-area-inset-bottom,0px));
      z-index:1000;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      flex-wrap:wrap;
      padding:8px 10px;
      border-radius:14px;
      background:rgba(15,23,42,.35);
      border:1px solid rgba(255,255,255,.2);
      box-shadow:0 8px 18px rgba(2,8,23,.28);
      backdrop-filter:blur(8px) saturate(120%);
      -webkit-backdrop-filter:blur(8px) saturate(120%);
      width:min(540px,calc(100vw - calc(var(--page-gutter)*2)));
      max-width:calc(100vw - calc(var(--page-gutter)*2));
    }
    footer.page-footer{
      text-align:center;
      color:#ffffff;
      text-shadow:0 2px 6px rgba(0,0,0,.5);
      margin:6px 0 var(--floatbar-gap);
      padding-left:var(--page-gutter);
      padding-right:var(--page-gutter);
      font-size:clamp(12px,3.2vw,16px);
      line-height:1.4;
    }

    @media (max-width:640px){
      .dose-row,.conc-row{
        display:grid;
        grid-template-columns:auto 1fr;
        align-items:center;
        column-gap:8px;
        width:100%;
        max-width:520px;
        margin-left:auto;
        margin-right:auto;
      }
      .dose-row>label,.conc-row>label{
        white-space:nowrap;
        max-width:44vw;
        font-size:14px;
        line-height:1.2;
      }
      .dose-row>input[type="number"],.conc-row>select{
        min-width:0;
        width:100%;
        font-size:14px;
        padding:8px 10px;
        height:38px;
        box-sizing:border-box;
      }
      .calc-row>.btn{min-width:120px}
    }
    @media (max-width:360px){
      .dose-row>label,.conc-row>label{
        font-size:13px;
        max-width:42vw;
      }
      .dose-row>input[type="number"],.conc-row>select{
        font-size:13px;
        padding:7px 9px;
        height:36px;
      }
    }
    @media (max-width:640px){
      .title-badge{
        font-size:22px;
        padding:8px 14px;
      }
      .container{padding:14px}
      .calc-row{gap:8px}
    }
  </style>
</head>
<body>

  <div class="title-badge">Amikacin (Amikin) : 500 mg / 2 ml</div>

  <div class="container">
    <!-- ฟอร์ม #1: คำนวณ mg -> mL -->
    <div class="calc-box">
      <form action="./amikin.html" method="post" class="calc-row">
        <input type="hidden" name="action" value="dose" />
        <div class="dose-row">
          <label for="dose">กรอกขนาดยา (mg):</label>
          <input type="number" id="dose" name="dose" placeholder="ขนาดยา (mg)"
                 required step="0.01"
                 value="">
        </div>
        <button type="submit" class="btn btn-blue">คำนวณ</button>
      </form>
    </div>

    

    

<!-- ฟอร์ม #2: เลือกเงื่อนไข -->
<div class="calc-box"
     
       style="display:none;opacity:.55;pointer-events:none"
     >
  <form action="./amikin.html" method="post" class="calc-row">
    <input type="hidden" name="action" value="condition" />
    <input type="hidden" name="dose_hidden"
           value="">
    <input type="hidden" name="result_ml_hidden"
           value="">
    <label for="multiplication">เลือกเงื่อนไข:</label>
    <select name="multiplication" id="multiplication" required>
      <option value="" disabled selected>— เลือก —</option>
      <option value="3" >
        3 เท่า (รวมเป้าหมาย ~ 9 ml)
      </option>
      <option value="6" >
        6 เท่า (รวมเป้าหมาย ~ 6 ml)
      </option>
    </select>
    <button type="submit" class="btn btn-blue">คำนวณต่อ</button>
  </form>
</div>


    

    <!-- ข้อมูลคลินิก -->
    <div class="bullet">
      <p class="muted">☞ <b>ขนาดยาแนะนำ:</b> 50 mg/kg/dose</p>

      <p class="section-head">Solution / Small dose</p>
      <ul class="muted">
        <li>ยา 0.2 ml + D5W up to 1 ml → <b>50 mg/ml</b></li>
      </ul>

      <p class="section-head">ความเข้มข้นขณะให้</p>
      <ul class="muted">
        <li>2.5 – 10 mg/ml</li>
      </ul>

      <p class="section-head">ระยะเวลาในการบริหารยา</p>
      <ul class="muted">
        <li>30 – 60 mins</li>
      </ul>

      <p class="section-head">ความคงตัวหลังเจือจาง</p>
      <ul class="muted">
        <li>24 ชั่วโมง ที่อุณหภูมิห้อง 15–25°C</li>
      </ul>

      <p class="section-head">ข้อควรระวัง / การติดตาม (Type A ADR)</p>
      <ul class="muted">
        <li>Urine output, BUN, Scr</li>
        <li>Hearing parameter</li>
      </ul>

      <p class="section-head">Half-life</p>
      <ul class="muted">
        <li>q 24 hr = 9 hr</li>
        <li>q 36 hr = 12 hr</li>
        <li>q 48 hr = 16 hr</li>
      </ul>
    </div>
  </div>

  <footer class="page-footer">
    <p>Developed by Sukhontha Boonsookchan | update 2025-12-03 00:26</p>
  </footer>

  <div class="float-actions">
    <a href="./Medication_administration.html" class="btn btn-cyan">Back</a>
    <a href="./index.html" class="btn btn-red">Back to Home</a>
  </div>

  <!-- JS calculator สำหรับ GitHub Pages (static) -->
  <script>
  (function() {
    var host = window.location.hostname || "";
    // ทำงานเฉพาะบน GitHub Pages (เช่น 060531.github.io)
    var isGithub = host.endsWith("github.io");
    if (!isGithub) return;

    var doseInput = document.getElementById("dose");
    var multSelect = document.getElementById("multiplication");
    if (!doseInput || !multSelect) return;

    var doseActionInput = document.querySelector('input[name="action"][value="dose"]');
    var condActionInput = document.querySelector('input[name="action"][value="condition"]');
    if (!doseActionInput || !condActionInput) return;

    var formDose = doseActionInput.form;
    var formCond = condActionInput.form;
    if (!formDose || !formCond) return;

    var doseVal = null;
    var resultMlVal = null;

    function createOrGetResultBox(id, refNode) {
      var box = document.getElementById(id);
      if (!box) {
        box = document.createElement("div");
        box.id = id;
        box.className = "result";
        refNode.parentNode.insertBefore(box, refNode.nextSibling);
      }
      return box;
    }

    function format2(num) {
      return Number(num).toFixed(2);
    }

    // --------------------------
    // ขั้นที่ 1: dose (mg) → mL
    // --------------------------
    formDose.addEventListener("submit", function(ev) {
      ev.preventDefault();

      var raw = (doseInput.value || "").trim();
      var d = parseFloat(raw);
      if (isNaN(d) || d < 0) {
        alert("ข้อมูลไม่ถูกต้อง: dose ต้องเป็นตัวเลข ≥ 0");
        return;
      }

      doseVal = parseFloat(format2(d));
      resultMlVal = parseFloat(format2((d * 2.0) / 500.0));

      // sync ไปใส่ hidden field ด้วย เผื่อใช้ใน step 2
      var hiddenDose = document.querySelector('input[name="dose_hidden"]');
      var hiddenRes = document.querySelector('input[name="result_ml_hidden"]');
      if (hiddenDose) hiddenDose.value = format2(doseVal);
      if (hiddenRes) hiddenRes.value = format2(resultMlVal);

      // แสดงผลลัพธ์ step 1 ใต้กล่องคำนวณแรก
      var box = createOrGetResultBox("gh-dose-result", formDose.closest(".calc-box"));
      box.innerHTML =
        '<p><b>Order:</b> Amikacin ' + format2(doseVal) + ' mg</p>' +
        '<p><b>สูตรจากสต็อก 500 mg / 2 ml</b> → ' +
        '<span class="mono">ml = (mg × 2) / 500</span></p>' +
        '<p>แทนค่า: <span class="mono">' + format2(doseVal) +
        ' × 2 / 500 = <span class="pill-red">' + format2(resultMlVal) +
        '</span> ml</span></p>';

      // เปิดให้เลือก step 2 ได้ (ปลด opacity + pointer-events)
      var calcBox2 = formCond.closest(".calc-box");
      if (calcBox2) {
        calcBox2.style.display = "block";      // ✅ เปิดให้มองเห็น
        calcBox2.style.opacity = "1";          // ✅ เอาโปร่งให้ชัด
        calcBox2.style.pointerEvents = "auto"; // ✅ กดเลือกเมนูได้
      }
    });

    // --------------------------
    // ขั้นที่ 2: คูณ 3X หรือ 6X
    // --------------------------
    formCond.addEventListener("submit", function(ev) {
      ev.preventDefault();

      if (doseVal === null || resultMlVal === null) {
        alert("โปรดคำนวณขั้นตอนที่ 1 ก่อน");
        return;
      }

      var m = parseInt(multSelect.value, 10);
      if (!m || (m !== 3 && m !== 6)) {
        alert("multiplication ต้องเป็น 3 หรือ 6");
        return;
      }

      var finalResult = parseFloat(format2(resultMlVal * m));

      var config;
      if (m === 3) {
        config = {
          targetTotal: 9.0,
          msgBlock: "ปริมาณที่บริหารเข้าทารก ≈ 3 mL → ตั้งอัตรา 6 mL/hr",
          extraTitle: "การบริหารยาโดย Intermittent intravenous infusion pump",
          extraDetails: [
            "สำหรับทารกที่มีน้ำหนักมากกว่า 1,500 กรัม",
            "กำหนดให้ปริมาณสารละลายยา (ปริมาณยา + สารละลายเชื้อจางยา) = 8 ml.",
            "(ความจุของ Extension Tube ประมาณ 5 ml. + Volume ที่ต้องบริหารเข้าผู้ป่วย 3 ml.)",
            "<div style='text-align:center'>(3X + สารละลายเจือจาง Up to 9 ml.)</div>",
            "การเตรียมยา:",
            "1. คำนวณปริมาณยาที่ต้องการใช้เป็นมิลลิลิตร (ml.) แทนค่าในสูตร",
            "2. ใช้ Syringe ขนาดที่เหมาะสม ดูดปริมาณยาที่ต้องการเตรียมไว้",
            "3. ใช้ Syringe ขนาด 10 ml. หรือ 20 ml. ดูดปริมาณสารละลายเชื้อจางยาเตรียมไว้",
            "4. ผสมยาใน Syringe ที่มีสารละลายเชื้อจางยาอยู่ Mixed ให้เข้ากัน",
            "5. ต่อ Syringe กับ Extension Tube นำไปวางบน Syringe pump กด Start ตั้งอัตราเร็ว 6 ml/hr.",
            "6. Purge ยาให้ทั่วท่อโดยการดัน Syringe 3 ml. แล้วจึงบริหารผู้ป่วย"
          ]
        };
      } else {
        config = {
          targetTotal: 6.0,
          msgBlock: "ปริมาณที่บริหารเข้าทารก ≈ 1 mL → ตั้งอัตรา 2 mL/hr",
          extraTitle: "การบริหารยาโดย Intermittent intravenous infusion",
          extraDetails: [
            "สำหรับทารกที่มีน้ำหนักน้อยกว่า 1,500 กรัม",
            "1. กำหนดให้สารละลายยาซึ่งบริหารเข้าสู่ผู้ป่วยปริมาณเท่ากับ 1 ml.",
            "2. ให้ X คือ ปริมาณยาที่ต้องการเตรียม กำหนดสูตรในการเตรียมสารละลายยา ดังนี้:",
            "<div style='text-align:center'>(6X + สารละลายเจือจาง Up to 6 ml.)</div>",
            "3. จากข้อ 2 จะได้สารละลายทั้งหมด 6 ml. ซึ่งหมายถึง ความจุของ Extension Tube ประมาณ 5 ml. + Volume ที่ต้องการบริหารเข้าสู่ผู้ป่วย 1 ml.",
            "4. บริหารยาโดยใช้ Syringe pump ตั้งอัตราเร็ว 2 ml/hr."
          ]
        };
      }

      var target = config.targetTotal;
      var need = target - finalResult;
      var diluent = need > 0 ? parseFloat(format2(need)) : 0.0;

      // กล่องผลลัพธ์หลัก
      var boxMain = createOrGetResultBox("gh-final-result", formCond.closest(".calc-box"));
      boxMain.innerHTML =
        "<p><b>ผลลัพธ์หลังจากคูณ " + m + " เท่า</b></p>" +
        "<p>ปริมาณยาหลังคูณ = <span class=\"pill-red\">" + format2(finalResult) + "</span> ml</p>" +
        "<p>ปริมาณสารละลายทั้งหมดที่ต้องการ (เป้าหมาย) = " + format2(target) + " ml</p>" +
        "<p>ดังนั้น <b>ต้องเติมตัวทำละลาย</b> = <span class=\"mono\">" + format2(diluent) + "</span> ml</p>" +
        "<p style=\"background-color:#f1b81b;padding:5px;border-radius:5px;\"><b>" + config.msgBlock + "</b></p>";

      // กล่องคำอธิบาย extra เหมือนฝั่ง Flask
      var boxExtra = createOrGetResultBox("gh-final-extra", boxMain);
      var html =
        '<p style="font-weight:800;text-align:center;margin:6px 0">' +
        config.extraTitle +
        "</p><div class=\"muted\">";
      config.extraDetails.forEach(function(d) {
        if (d.indexOf("Up to") !== -1) {
          html += "<div style=\"background:#ffeb3b;font-weight:700;padding:8px;text-align:center;border-radius:6px;margin:10px 0\">" +
                  d +
                  "</div>";
        } else {
          html += "<p style=\"margin:6px 0\">" + d + "</p>";
        }
      });
      html += "</div>";
      boxExtra.innerHTML = html;
    });
  })();
  </script>
</body>
</html>